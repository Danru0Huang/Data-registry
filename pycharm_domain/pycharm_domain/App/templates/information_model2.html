<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>数据共享及演化工具</title>
		<!-- 引入 Vue.js -->
		<script src="/static/js/vue.js"></script>

		<!-- 引入 Element UI 的样式文件 -->
		<link rel="stylesheet" href="/static/element-ui/theme-chalk/index.css">
		<!-- 引入 Element UI 的 JavaScript文件 -->
		<script src="/static/element-ui/index.js"></script>

		<!-- 引入 axios 的 JavaScript文件 -->
		<script src="/static/js/axios.min.js"></script>

		<!-- 引入 echarts 的 JavaScript文件 -->
		<script src="/static/js/echarts.min.js"></script>


		<style>
			.el-menu-vertical-demo{
				height: 100vh;}
			.el-header {
				background-color: #B3C0D1;
				color: #333;
				line-height: 60px;
			}

			.el-aside {
				color: #333;
			}

			.chat-container {
				height: 750px;
				padding: 5px;
				/* display: flex; */
				flex-direction: column;
			}

			.message-container {
				flex: 1;
				max-height: calc(100% - 60px);
				overflow-y: auto;
				padding-bottom: 10px;
			}

			.message {
				display: flex;
				justify-content: flex-start;
				align-items: flex-start;
				margin-bottom: 10px;
			}

			.message.user .message-bubble {
				margin-left: auto;
				background-color: #DCF8C6;
				color: #000;
			}

			.message.bot .message-bubble {
				margin-right: auto;
				background-color: #F0F0F0;
				color: #000;
			}

			.message-bubble {
				max-width: 70%;
				padding: 10px;
				border-radius: 10px;
				background: #fff;
				box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
			}

			.input-container {

				gap: 2px;
				/* margin-top: 10px; */
			}

			.input-container .el-input {
				flex: 2;
				width: 200px;
				border-radius: 20px;
				padding: 5px 5px;
			}

			.input-container button {
				flex: none;
				border-radius: 20%;
				width: 100px;
				height: 40px;
			}

			.text {
				font-size: 14px;
			}

			.item {
				margin-bottom: 18px;
			}

			.clearfix:before,
			.clearfix:after {
				display: table;
				content: "";
			}

			.clearfix:after {
				clear: both
			}

			.box-card {
				width: center;

			}
		</style>
	</head>
	<body>
		<div id="app">
			<el-container style="height: auto; border: 1px solid #eee">
				<el-aside width="250px" style="background-color: #545c64">
					<el-row class="tac">
						<el-col :span="24">
							<el-menu :default-active="activeMenu" class="el-menu-vertical-demo" @open="handleOpen"
								@close="handleClose" background-color="#545c64" text-color="#fff"
								active-text-color="#ffd04b">

								<el-submenu index="1">
									<template slot="title">
										<i class="el-icon-location"></i>
										<span>信息模型</span>
									</template>
									<el-menu-item-group>
										<a href="/information_model2">
											<el-menu-item index="1-1">注册</el-menu-item>
										</a>
										<a href="/search2">
											<el-menu-item index="1-2">查询</el-menu-item>
										</a>
									</el-menu-item-group>
								</el-submenu>
								
								<el-submenu index="2">
									<template slot="title">
										<i class="el-icon-location"></i>
										<span>MDR</span>
									</template>
									<el-menu-item-group>
										<a href="/mdr">
											<el-menu-item index="2-1">注册</el-menu-item>
										</a>
										<a href="/search1">
											<el-menu-item index="2-2">查询</el-menu-item>
										</a>
									</el-menu-item-group>
								</el-submenu>

								
								<a href="/index2">
									<el-menu-item index="3">
										<i class="el-icon-menu"></i>
										<span slot="title">首页</span>
									</el-menu-item>
								</a>
								
								<a href="/register_subDomain">
									<el-menu-item index="4">
										<i class="el-icon-menu"></i>
										<span slot="title">子域注册</span>
									</el-menu-item>
								</a>

							</el-menu>
						</el-col>
					</el-row>

				</el-aside>

				<el-container>
					<el-main>
						<el-card class="box-card">
							<div slot="header" class="clearfix input-container" style="text-align: center;">
								<!-- <input type="text" v-model="searchInput" placeholder="请输入你要检索的内容..."> -->
								<el-button type="primary" icon="el-icon-plus" @click="showDialogOfAddModel = true"
									style="width: 150px;" round>添加信息模型</el-button>
								<el-select v-model="selectedModelName" filterable
									@change="handleSelectChangeOfModelName" placeholder="请选择查询模型">
									<el-option v-for="item in optionsOfModelName" :key="item.value" :label="item.label"
										:value="item.value"></el-option>
								</el-select>
							</div>
							<!-- <div class="chat-container" :id="chartId"></div> -->
							<el-row :gutter="5">
								<el-col :span="17">
									<!-- 展示信息模型图谱区域 -->
									<div class="chat-container" :id="chartId"></div>
								</el-col>
								<el-col :span="7">
									
									<!-- 点击下方按钮在页面右侧展示对应注册类别的注册表单 -->
									<el-button type="primary" @click="changeShowAddModelClassTable">注册类</el-button>
									<el-button type="primary" @click="changeShowAddModelPropertyTable">注册属性</el-button>
									<el-button type="primary" @click="changeShowAddModelRelationTable">注册关系</el-button>
									
									<!-- 注册类表单 -->
									<el-form ref="addModelClassTableForm" :model="addClassName" label-width="auto"
										style="margin-top: 20px;" v-show="showAddModelClassTable">
										<div style="text-align: center;">
											<h5>添加类</h5>
										</div>
										<el-form-item label="模型名称">
											<el-input v-model="selectedModelName" :disabled="true"></el-input>
										</el-form-item>
										<el-form-item label="类名">
											<el-input v-model="addClassName.class_name"></el-input>
										</el-form-item>
										<el-form-item>
											<el-button type="primary" @click="addClass">注册类</el-button>
											<el-button type="danger" @click="resetForm">重置</el-button>
										</el-form-item>
									</el-form>
									
									<!-- 注册属性表单 -->
									<el-form ref="addModelPropertyTableForm" :model="addPropertyName" label-width="auto"
										style="margin-top: 20px;" v-show="showAddModelPropertyTable">
										<div style="text-align: center;">
											<h5>添加属性</h5>
										</div>
										<el-form-item label="模型名称">
											<el-input v-model="selectedModelName" :disabled="true"></el-input>
										</el-form-item>
										<el-form-item label="类">
											<template>
												<el-select v-model="addPropertyName.class_name" filterable
													default-first-option placeholder="请选择类">
													<el-option v-for="item in optionsOfModelClassName"
														:key="item.value" :label="item.label"
														:value="item.value">
													</el-option>
												</el-select>
											</template>
										</el-form-item>
										<div v-for="(property, index) in addPropertyName.property_names" :key="index">
											<el-form-item :label="`属性名 ${index + 1}`">
												<div style="display: flex; align-items: center;">
													<el-input v-model="addPropertyName.property_names[index]"
														clearable></el-input>
													<el-button icon="el-icon-delete" @click="removePropertyItem(index)"
														circle></el-button>
												</div>
											</el-form-item>
										</div>
										<el-form-item>
											<el-button icon="el-icon-plus" @click="addPropertyItem" circle></el-button>
											<el-button type="primary" @click="addProperty">注册属性</el-button>
											<el-button type="danger" @click="resetForm">重置</el-button>
										</el-form-item>
									</el-form>
									
									<!-- 注册关系表单 -->
									<el-form ref="addModelRelaionTableForm" :model="addRelationData" label-width="auto"
										style="margin-top: 20px;" v-show="showAddModelRelationTable">
										<div style="text-align: center;">
											<h5>添加关系</h5>
										</div>
										<el-form-item label="模型名称">
											<el-input v-model="selectedModelName" :disabled="true"></el-input>
										</el-form-item>
										<el-form-item label="类1">
											<template>
												<el-select v-model="addRelationData.class_name1" filterable
													default-first-option placeholder="请选择类">
													<el-option v-for="item in optionsOfModelClassName"
														:key="item.value" :label="item.label"
														:value="item.value">
													</el-option>
												</el-select>
											</template>
										</el-form-item>
										<el-form-item label="类 2">
											<template>
												<el-select v-model="addRelationData.class_name2" filterable
													default-first-option placeholder="请选择类">
													<el-option v-for="item in optionsOfModelClassName"
														:key="item.value" :label="item.label"
														:value="item.value">
													</el-option>
												</el-select>
											</template>
										</el-form-item>
										<el-form-item label="关系">
											<el-input v-model="addRelationData.relation" clearable></el-input>
										</el-form-item>
										<el-form-item>
											<el-button type="primary" @click="addRelation">注册关系</el-button>
											<el-button type="danger" @click="resetForm">重置</el-button>
										</el-form-item>
									</el-form>


									<!-- 点击导航栏上方的添加信息模型时弹出该对话框，注册新的模型，要求注册模型时必须为该模型添加一个新的类 -->
									<el-dialog title="添加模型" :visible.sync="showDialogOfAddModel" width="25%"
										:before-close="dialogClose" center>
										<span>
											<el-form ref="addModelForm" :model="addModelData" label-width="auto"
												style="margin-top: 20px;">
												<el-form-item label="模型名称">
													<el-input v-model="addModelData.model_name" clearable></el-input>
												</el-form-item>
												<el-form-item label="类名称">
													<el-input v-model="addModelData.class_name" clearable></el-input>
												</el-form-item>
											</el-form>
										</span>
										<span slot="footer" class="dialog-footer">
											<el-button type="danger" @click="resetForm">重置</el-button>
											<el-button type="danger" @click="showDialogOfAddModel = false">取
												消</el-button>
											<!-- <el-button type="primary" @click="showDialogOfAddProperty = false">确 定</el-button> -->
											<el-button type="primary" @click="addModel">添加</el-button>
										</span>
									</el-dialog>
									
									<!-- 注册属性弹框 -->
									<el-dialog title="添加属性" :visible.sync="showDialogOfAddProperty" width="25%"
										:before-close="dialogClose" center>
										<span>
											<el-form ref="addPropertyForm" :model="addPropertyName" label-width="auto"
												style="margin-top: 20px;">
												<div v-for="(property, index) in addPropertyName.property_names"
													:key="index">
													<el-form-item :label="`属性名 ${index + 1}`">
														<div style="display: flex; align-items: center;">
															<el-input v-model="addPropertyName.property_names[index]"
																clearable></el-input>
															<el-button icon="el-icon-delete"
																@click="removePropertyItem(index)" circle></el-button>
														</div>
													</el-form-item>
												</div>
											</el-form>
										</span>
										<span slot="footer" class="dialog-footer">
											<el-button icon="el-icon-plus" @click="addPropertyItem" circle></el-button>
											<el-button type="danger" @click="showDialogOfAddProperty = false">取
												消</el-button>
											<!-- <el-button type="primary" @click="showDialogOfAddProperty = false">确 定</el-button> -->
											<el-button type="primary" @click="addProperty">添加</el-button>
											<el-button type="danger" @click="resetFormOfAddProperty">重置</el-button>
										</span>
									</el-dialog>
									
									<!-- 当点击图谱中标签为模型类的节点时弹出该弹框，用于选择为该模型类添加关系或者属性，
									并根据用户选择弹出对应的属性添加弹框或关系添加弹框 -->
									<el-dialog title="添加属性/关系" :visible.sync="showDialogOfSelect" width="25%"
										:before-close="dialogClose" center>
										<span>
											<el-button type="primary" @click="selectOfAddRelation">添加关系</el-button>
										</span>
										<span>
											<el-button type="primary" @click="selectOfAddProperty">添加属性</el-button>
										</span>
										<span slot="footer" class="dialog-footer">
											<el-button type="danger" @click="showDialogOfSelect = false">取消</el-button>
											<!-- <el-button type="primary" @click="showDialogOfAddProperty = false">确 定</el-button> -->
										</span>
									</el-dialog>

									<!-- 当点击图谱中标签为模型的节点时，弹出该弹框，用于为该模型添加新的类 -->
									<el-dialog title="添加类" :visible.sync="showDialogOfAddClass" width="25%"
										:before-close="dialogClose" center>
										<span>
											<el-form ref="addClassForm" :model="addClassName" label-width="auto"
												style="margin-top: 20px;">
												<el-form-item label="名称">
													<el-input v-model="addClassName.class_name" clearable></el-input>
												</el-form-item>
											</el-form>
										</span>
										<span slot="footer" class="dialog-footer">
											<el-button type="danger"
												@click="showDialogOfAddClass = false">取消</el-button>
											<!-- <el-button type="primary" @click="showDialogOfAddProperty = false">确 定</el-button> -->
											<el-button type="primary" @click="addClass">添加</el-button>
											<el-button type="danger" @click="resetForm">重置</el-button>
										</span>
									</el-dialog>
									
									<!-- 添加关系弹框 -->
									<el-dialog title="添加关系" :visible.sync="showDialogOfAddRelation" width="25%"
										:before-close="dialogClose" center>
										<span>
											<el-form ref="addRelationForm" :model="addRelationData" label-width="auto"
												style="margin-top: 20px;">
												<el-form-item label="类1">
													<el-input v-model="addRelationData.class_name1"
														:disabled="true"></el-input>
												</el-form-item>
												<el-form-item label="类 2">
													<template>
														<el-select v-model="addRelationData.class_name2" filterable
															default-first-option placeholder="请选择类">
															<el-option v-for="item in optionsOfModelClassName"
																:key="item.value" :label="item.label"
																:value="item.value">
															</el-option>
														</el-select>
													</template>
												</el-form-item>
												<el-form-item label="关系">
													<el-input v-model="addRelationData.relation" clearable></el-input>
												</el-form-item>
											</el-form>
										</span>
										<span slot="footer" class="dialog-footer">
											<el-button type="danger"
												@click="showDialogOfAddRelation = false">取消</el-button>
											<el-button type="primary" @click="addRelation">添加</el-button>
											<el-button type="danger" @click="resetFormOfAddRelation">重置</el-button>
										</span>
									</el-dialog>



								</el-col>
							</el-row>
						</el-card>
					</el-main>
				</el-container>

			</el-container>
		</div>

		<script src="/static/js/information_model2.js"></script>
	</body>
</html>